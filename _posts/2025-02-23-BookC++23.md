---
layout:       post
title:        "现代C++从入门到实战"
subtitle:     "Modern C++ from novice to practice"
date:         2025-02-23 20:10:00
author:       "hwdong"
header-img:   "img/home_bg.jpg"
header-mask:  0.3
catalog:      true
multilingual: true
tags:
    - C++
---

## 10.1 继承与派生

*   **继承的概念：** 从已有的类（基类）创建新的类（派生类），实现代码复用、功能扩展和层次结构。
*   **`is-a` 关系：** 派生类是一种特殊的基类。
*   **`belong-to` 关系：** 组合关系，一个类包含另一个类的对象作为成员。
*   **派生类的定义：**
    ```cpp
    class 派生类名 : 继承方式 基类名 {
        // 派生类的成员
    };
    ```
*   **成员隐藏（Hide）：** 派生类可以定义与基类同名的成员，隐藏基类的对应成员。
    *   访问被隐藏的基类成员：`基类名::成员名`
*   **继承方式与访问控制：**
    *   `public` 继承：基类的 `public` 和 `protected` 成员在派生类中保持不变。
    *   `protected` 继承：基类的 `public` 和 `protected` 成员在派生类中变为 `protected`。
    *   `private` 继承：基类的 `public` 和 `protected` 成员在派生类中变为 `private`。
    *   基类的 `private` 成员在派生类中始终不可见。
*   **对象切割（Object Slicing）：** 将派生类对象赋值给基类对象时，派生类特有的成员被切掉。
    *   避免对象切割：使用基类指针或引用。
*   **向上类型转换（Upcasting）：** 将派生类指针或引用赋值给基类指针或引用，隐式且安全。
*   **向下类型转换（Downcasting）：** 将基类指针或引用转换为派生类指针或引用，需要显式转换，存在风险。
    *   `static_cast`：编译时类型转换，不进行运行时检查。
    *   `dynamic_cast`：运行时类型转换，更安全，但需要 RTTI（运行时类型信息）支持。转换失败返回 `nullptr`。

## 10.2 派生类的构造函数、析构函数与拷贝构造函数

*   **构造顺序：** 基类构造函数 -> 派生类构造函数。
*   **析构顺序：** 派生类析构函数 -> 基类析构函数。
*   **构造函数初始化列表：** 派生类必须在初始化列表中显式调用基类的构造函数，尤其是当基类没有默认构造函数时。
*   **拷贝构造函数：** 派生类拷贝构造函数应显式调用基类的拷贝构造函数，确保基类部分正确初始化。

## 10.3 虚函数与多态

*   **虚函数（Virtual Function）：** 在基类中声明的函数，可以在派生类中重写，实现运行时多态。
    ```cpp
    virtual 返回类型 函数名 (参数列表) { ... }
    ```
*   **虚函数表（VTable）和虚函数表指针（VPtr）：** 虚函数的实现机制。
*   **虚析构函数（Virtual Destructor）：**
    *   当通过基类指针删除派生类对象时，确保派生类的析构函数也被调用，防止资源泄漏。
    *   如果一个类设计为基类，应该将其析构函数声明为 `virtual`。
*   **编译时多态（静态多态）：** 函数重载、运算符重载、模板。在编译时确定调用哪个函数。
*   **运行时多态（动态多态）：** 通过虚函数和继承实现，在运行时根据对象的实际类型来决定调用哪个函数。
*   **`override` 关键字：** 显式标记派生类重写基类的虚函数，帮助编译器检查。
*   **`final` 关键字：** 阻止派生类继续重写虚函数，或者阻止一个类被继承。

**总结：** 本章介绍了 C++ 中继承与派生类的基本概念，包括继承方式、访问控制、对象切割、类型转换，以及虚函数与多态等核心内容。掌握这些知识对于理解和编写面向对象的 C++ 程序至关重要。
